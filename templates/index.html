<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Smart Docs Assistant</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://unpkg.com/htmx.org@1.10.0"></script>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">Smart Documentation Assistant</div>

        {% if not db_ready %}
        <div class="warning-banner" style="background:#fff3cd;color:#664d03;padding:8px 12px;border:1px solid #ffe69c;border-radius:4px;margin:8px 0;">
            No vector database initialized yet. Use ⚙️ to create it.
        </div>
        {% endif %}

        <div id="chatbox" class="chat-box">
            <!-- server responses and user messages will be appended here -->
        </div>

        <!-- wrapper keeps settings next to the chat form without nesting forms -->
        <div class="chat-input-area-wrapper" style="display:flex;align-items:center;gap:8px;">
            <!-- Settings control -->
            <details class="settings-toggle" role="group" aria-label="">
                <summary class="settings-button" title="Settings">⚙️</summary>

                <!-- DB creation form -->
                <div class="settings-panel">
                    <form hx-post="/create_db" hx-target="#db-status" hx-swap="innerHTML" class="db-form">
                        <label class="sr-only">Data path</label>
                        <input type="text" name="data_path" placeholder="/path/to/data" required>
                        <button type="submit">Create / Update DB</button>
                    </form>
                    <div id="db-status" class="db-status"></div>
                </div>
            </details>

            <!-- Chat form remains standalone -->
            <form id="chat-form" class="chat-input-area" hx-post="/send" hx-target="#chatbox" hx-swap="beforeend"
                style="flex:1;display:flex;gap:8px;align-items:center;">
                <input type="text" name="message" id="input" placeholder="Type a message..." autocomplete="off"
                    class="chat-input" required style="flex:1;">
                <button type="submit" class="send-btn">&#8593;</button>
            </form>
        </div>
    </div>
</body>
</html>